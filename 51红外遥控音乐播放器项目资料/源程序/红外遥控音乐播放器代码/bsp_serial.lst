C51 COMPILER V9.00   BSP_SERIAL                                                            02/22/2019 13:55:16 PAGE 1   


C51 COMPILER V9.00, COMPILATION OF MODULE BSP_SERIAL
OBJECT MODULE PLACED IN bsp_serial.obj
COMPILER INVOKED BY: D:\Keil4\C51\BIN\C51.EXE bsp\src\bsp_serial.c LARGE BROWSE INCDIR(.\bsp;.\app\inc;.\bsp\inc) DEBUG 
                    -OBJECTEXTEND PRINT(.\bsp_serial.lst) OBJECT(bsp_serial.obj)

line level    source

   1          #include "bsp.h"
   2          
   3          volatile unsigned char sending;
   4          
   5          void bsp_InitSerial(void)
   6          {
   7   1         SCON = 0X50 ;//0101 0000
   8   1         //控制定时器1 产生需要的波特率
   9   1         TMOD |= 0X20;//T1 处于工作模式2  自动重装载初始值
  10   1         //赋定时器的初始值 ，参考ppt中的表格
  11   1         TH1 = 0XFD;
  12   1         TL1 = 0XFD;
  13   1         TR1 = 1;
  14   1         EA = 1; //总的中断开关
  15   1         ES = 1; //串口的中断开关
  16   1      }
  17          
  18          void uart(void) interrupt 4              //串口发送中断
  19          {
  20   1       if(RI)    //收到数据
  21   1       {
  22   2        RI=0;   //清中断请求
  23   2       }
  24   1       else      //发送完一字节数据
  25   1       {
  26   2        TI=0;
  27   2        sending=0;  //清正在发送标志
  28   2       }
  29   1      }
  30          
  31          void UART1_SendByte(u8 dat)
  32          {
  33   1         SBUF=dat; //将数据写入到串口缓冲
  34   1         sending=1;    //设置发送标志
  35   1         while(sending); //等待发送完毕
  36   1      }
  37          
  38          /*********************************************************************************************
  39          //函数名:Next_Play()
  40          //
  41          //功能说明:播放下一首
  42          //
  43          //入口参数:
  44          //
  45          //出口参数:NO
  46          ***********************************************************************************************/
  47          void Next_Play()
  48          {
  49   1          UART1_SendByte(0x7E); 
  50   1          UART1_SendByte(0x02);
  51   1          UART1_SendByte(0x03);
  52   1          UART1_SendByte(0xEF); 
  53   1      }
  54          
C51 COMPILER V9.00   BSP_SERIAL                                                            02/22/2019 13:55:16 PAGE 2   

  55          /*********************************************************************************************
  56          //函数名:Last_Play()
  57          //
  58          //功能说明:播放上一首
  59          //
  60          //入口参数:
  61          //
  62          //出口参数:NO
  63          ***********************************************************************************************/
  64          void Last_Play()
  65          {
  66   1          UART1_SendByte(0x7E); 
  67   1          UART1_SendByte(0x02);
  68   1          UART1_SendByte(0x04);
  69   1          UART1_SendByte(0xEF); 
  70   1      }
  71          /*********************************************************************************************
  72          //函数名:Specify_Musi_Play()
  73          //
  74          //功能说明:指定曲目播放
  75          //
  76          //入口参数:
  77          //
  78          //出口参数:NO
  79          ***********************************************************************************************/
  80          void Specify_Musi_Play(u8 num)
  81          {
  82   1          UART1_SendByte(0x7E); 
  83   1          UART1_SendByte(0x04);
  84   1          UART1_SendByte(0x33);
  85   1          UART1_SendByte(0x00);
  86   1          UART1_SendByte(num);
  87   1          UART1_SendByte(0xEF); 
  88   1      }
  89          
  90          /*********************************************************************************************
  91          //函数名:Volume_add()
  92          //
  93          //功能说明:音量加
  94          //
  95          //入口参数:
  96          //
  97          //出口参数:NO
  98          ***********************************************************************************************/
  99          /*void Volume_add()
 100          {
 101              UART1_SendByte(0x7E); 
 102              UART1_SendByte(0x02);
 103              UART1_SendByte(0x05);
 104              UART1_SendByte(0xEF); 
 105          }*/
 106          /*********************************************************************************************
 107          //函数名:Volume_nec()
 108          //
 109          //功能说明:音量减
 110          //
 111          //入口参数:
 112          //
 113          //出口参数:NO
 114          ***********************************************************************************************/
 115          /*void Volume_nec()
 116          {
C51 COMPILER V9.00   BSP_SERIAL                                                            02/22/2019 13:55:16 PAGE 3   

 117              UART1_SendByte(0x7E); 
 118              UART1_SendByte(0x02);
 119              UART1_SendByte(0x06);
 120              UART1_SendByte(0xEF); 
 121          }*/
 122          /*********************************************************************************************
 123          //函数名:Specify_Volume()
 124          //
 125          //功能说明:指定音量
 126          //
 127          //入口参数:
 128          //
 129          //出口参数:NO
 130          ***********************************************************************************************/
 131          void Specify_Volume(u8 num)
 132          {
 133   1          UART1_SendByte(0x7E); 
 134   1          UART1_SendByte(0x03);
 135   1          UART1_SendByte(0x31);
 136   1          UART1_SendByte(num);
 137   1          UART1_SendByte(0xEF); 
 138   1      }
 139          
 140          
 141          /*********************************************************************************************
 142          //函数名:Music_play()
 143          //
 144          //功能说明:播放(循环播放)
 145          //
 146          //入口参数:
 147          //
 148          //出口参数:NO
 149          ***********************************************************************************************/
 150          void Music_play()
 151          {
 152   1          UART1_SendByte(0x7E); 
 153   1          UART1_SendByte(0x02);
 154   1          UART1_SendByte(0x01);
 155   1          UART1_SendByte(0xEF); 
 156   1      }
 157          /*********************************************************************************************
 158          //函数名:Music_pause()
 159          //
 160          //功能说明:暂停(再次发送指令继续播放)
 161          //
 162          //入口参数:
 163          //
 164          //出口参数:NO
 165          ***********************************************************************************************/
 166          void Music_pause()
 167          {
 168   1          UART1_SendByte(0x7E); 
 169   1          UART1_SendByte(0x02);
 170   1          UART1_SendByte(0x0C);
 171   1          UART1_SendByte(0xEF); 
 172   1      }
 173          /*********************************************************************************************
 174          //函数名:Music_stop()
 175          //
 176          //功能说明:停止
 177          //
 178          //入口参数:
C51 COMPILER V9.00   BSP_SERIAL                                                            02/22/2019 13:55:16 PAGE 4   

 179          //
 180          //出口参数:NO
 181          ***********************************************************************************************/
 182          void Music_stop()
 183          {
 184   1          UART1_SendByte(0x7E); 
 185   1          UART1_SendByte(0x02);
 186   1          UART1_SendByte(0x0E);
 187   1          UART1_SendByte(0xEF); 
 188   1      }
 189          /*********************************************************************************************
 190          //函数名:Cycle_play()
 191          //
 192          //功能说明:全部循环
 193          //
 194          //入口参数:
 195          //
 196          //出口参数:NO
 197          ***********************************************************************************************/
 198          void Cycle_play()
 199          {
 200   1          UART1_SendByte(0x7E); 
 201   1          UART1_SendByte(0x03);
 202   1          UART1_SendByte(0x33);
 203   1          UART1_SendByte(0x00);
 204   1          UART1_SendByte(0xEF); 
 205   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    215    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =      1    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
